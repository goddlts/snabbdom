{"version":3,"sources":["snabbdom-patch.js"],"names":["f","exports","module","define","amd","window","global","self","this","snabbdom","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","Object","defineProperty","value","vnode_1","is","h","sel","b","children","text","data","undefined","array","primitive","vnode","addNS","ns","childData","default","./is","./vnode","2","htmlDomApi","createElement","tagName","document","createElementNS","namespaceURI","qualifiedName","createTextNode","createComment","insertBefore","parentNode","newNode","referenceNode","removeChild","node","child","appendChild","nextSibling","elm","setTextContent","textContent","getTextContent","isElement","nodeType","isText","isComment","3","Array","isArray","s","4","updateAttrs","oldVnode","key","oldAttrs","attrs","cur","setAttribute","removeAttribute","charCodeAt","setAttributeNS","attributesModule","create","update","5","updateClass","name","oldClass","class","klass","classList","remove","classModule","6","handleEvent","event","type","on","invokeHandler","handler","args","slice","push","apply","updateEventListeners","oldOn","oldListener","listener","oldElm","removeEventListener","addEventListener","eventListenersModule","destroy","7","updateProps","oldProps","props","propsModule","8","raf","bind","setTimeout","nextFrame","fn","reflowForced","setNextFrame","obj","prop","val","updateStyle","oldStyle","style","oldHasDel","removeProperty","delayed","name2","setProperty","styleModule","pre","rm","offsetLeft","amount","applied","getComputedStyle","split","indexOf","ev","target","9","snabbdom_1","attributes_1","class_1","props_1","style_1","eventlisteners_1","h_1","patch","init","snabbdomBundle","./h","./modules/attributes","./modules/class","./modules/eventlisteners","./modules/props","./modules/style","./snabbdom","10","htmldomapi_1","isUndef","isDef","emptyNode","sameVnode","vnode1","vnode2","createKeyToOldIdx","beginIdx","endIdx","_a","map","hooks","thunk_1","thunk","modules","domApi","j","cbs","api","hook","createRmCb","childElm","listeners","parent_1","createElm","insertedVnodeQueue","_b","_c","init_1","hashIdx","dotIdx","hash","dot","tag","Math","min","replace","ch","insert","addVnodes","parentElm","before","vnodes","startIdx","invokeDestroyHook","_d","i_1","j_1","removeVnodes","i_2","removeHook","patchVnode","_e","_f","_g","_h","_j","_k","prepatch","oldCh","i_3","newCh","oldKeyToIdx","idxInOld","elmToMove","oldStartIdx","newStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newEndIdx","newStartVnode","newEndVnode","updateChildren","postpatch","parent","isVnode","id","className","join","toLowerCase","emptyNodeAt","post","./htmldomapi","./thunk","11","copyToThunk","old","oldArgs","12"],"mappings":"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","file":"snabbdom-patch.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.snabbdom = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar vnode_1 = require(\"./vnode\");\r\nvar is = require(\"./is\");\r\nfunction addNS(data, children, sel) {\r\n    data.ns = 'http://www.w3.org/2000/svg';\r\n    if (sel !== 'foreignObject' && children !== undefined) {\r\n        for (var i = 0; i < children.length; ++i) {\r\n            var childData = children[i].data;\r\n            if (childData !== undefined) {\r\n                addNS(childData, children[i].children, children[i].sel);\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction h(sel, b, c) {\r\n    var data = {}, children, text, i;\r\n    if (c !== undefined) {\r\n        if (b !== null) {\r\n            data = b;\r\n        }\r\n        if (is.array(c)) {\r\n            children = c;\r\n        }\r\n        else if (is.primitive(c)) {\r\n            text = c;\r\n        }\r\n        else if (c && c.sel) {\r\n            children = [c];\r\n        }\r\n    }\r\n    else if (b !== undefined && b !== null) {\r\n        if (is.array(b)) {\r\n            children = b;\r\n        }\r\n        else if (is.primitive(b)) {\r\n            text = b;\r\n        }\r\n        else if (b && b.sel) {\r\n            children = [b];\r\n        }\r\n        else {\r\n            data = b;\r\n        }\r\n    }\r\n    if (children !== undefined) {\r\n        for (i = 0; i < children.length; ++i) {\r\n            if (is.primitive(children[i]))\r\n                children[i] = vnode_1.vnode(undefined, undefined, undefined, children[i], undefined);\r\n        }\r\n    }\r\n    if (sel[0] === 's' && sel[1] === 'v' && sel[2] === 'g' &&\r\n        (sel.length === 3 || sel[3] === '.' || sel[3] === '#')) {\r\n        addNS(data, children, sel);\r\n    }\r\n    return vnode_1.vnode(sel, data, children, text, undefined);\r\n}\r\nexports.h = h;\r\n;\r\nexports.default = h;\r\n\n},{\"./is\":3,\"./vnode\":12}],2:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction createElement(tagName) {\r\n    return document.createElement(tagName);\r\n}\r\nfunction createElementNS(namespaceURI, qualifiedName) {\r\n    return document.createElementNS(namespaceURI, qualifiedName);\r\n}\r\nfunction createTextNode(text) {\r\n    return document.createTextNode(text);\r\n}\r\nfunction createComment(text) {\r\n    return document.createComment(text);\r\n}\r\nfunction insertBefore(parentNode, newNode, referenceNode) {\r\n    parentNode.insertBefore(newNode, referenceNode);\r\n}\r\nfunction removeChild(node, child) {\r\n    node.removeChild(child);\r\n}\r\nfunction appendChild(node, child) {\r\n    node.appendChild(child);\r\n}\r\nfunction parentNode(node) {\r\n    return node.parentNode;\r\n}\r\nfunction nextSibling(node) {\r\n    return node.nextSibling;\r\n}\r\nfunction tagName(elm) {\r\n    return elm.tagName;\r\n}\r\nfunction setTextContent(node, text) {\r\n    node.textContent = text;\r\n}\r\nfunction getTextContent(node) {\r\n    return node.textContent;\r\n}\r\nfunction isElement(node) {\r\n    return node.nodeType === 1;\r\n}\r\nfunction isText(node) {\r\n    return node.nodeType === 3;\r\n}\r\nfunction isComment(node) {\r\n    return node.nodeType === 8;\r\n}\r\nexports.htmlDomApi = {\r\n    createElement: createElement,\r\n    createElementNS: createElementNS,\r\n    createTextNode: createTextNode,\r\n    createComment: createComment,\r\n    insertBefore: insertBefore,\r\n    removeChild: removeChild,\r\n    appendChild: appendChild,\r\n    parentNode: parentNode,\r\n    nextSibling: nextSibling,\r\n    tagName: tagName,\r\n    setTextContent: setTextContent,\r\n    getTextContent: getTextContent,\r\n    isElement: isElement,\r\n    isText: isText,\r\n    isComment: isComment,\r\n};\r\nexports.default = exports.htmlDomApi;\r\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.array = Array.isArray;\r\nfunction primitive(s) {\r\n    return typeof s === 'string' || typeof s === 'number';\r\n}\r\nexports.primitive = primitive;\r\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar xlinkNS = 'http://www.w3.org/1999/xlink';\r\nvar xmlNS = 'http://www.w3.org/XML/1998/namespace';\r\nvar colonChar = 58;\r\nvar xChar = 120;\r\nfunction updateAttrs(oldVnode, vnode) {\r\n    var key, elm = vnode.elm, oldAttrs = oldVnode.data.attrs, attrs = vnode.data.attrs;\r\n    if (!oldAttrs && !attrs)\r\n        return;\r\n    if (oldAttrs === attrs)\r\n        return;\r\n    oldAttrs = oldAttrs || {};\r\n    attrs = attrs || {};\r\n    // update modified attributes, add new attributes\r\n    for (key in attrs) {\r\n        var cur = attrs[key];\r\n        var old = oldAttrs[key];\r\n        if (old !== cur) {\r\n            if (cur === true) {\r\n                elm.setAttribute(key, \"\");\r\n            }\r\n            else if (cur === false) {\r\n                elm.removeAttribute(key);\r\n            }\r\n            else {\r\n                if (key.charCodeAt(0) !== xChar) {\r\n                    elm.setAttribute(key, cur);\r\n                }\r\n                else if (key.charCodeAt(3) === colonChar) {\r\n                    // Assume xml namespace\r\n                    elm.setAttributeNS(xmlNS, key, cur);\r\n                }\r\n                else if (key.charCodeAt(5) === colonChar) {\r\n                    // Assume xlink namespace\r\n                    elm.setAttributeNS(xlinkNS, key, cur);\r\n                }\r\n                else {\r\n                    elm.setAttribute(key, cur);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // remove removed attributes\r\n    // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)\r\n    // the other option is to remove all attributes with value == undefined\r\n    for (key in oldAttrs) {\r\n        if (!(key in attrs)) {\r\n            elm.removeAttribute(key);\r\n        }\r\n    }\r\n}\r\nexports.attributesModule = { create: updateAttrs, update: updateAttrs };\r\nexports.default = exports.attributesModule;\r\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction updateClass(oldVnode, vnode) {\r\n    var cur, name, elm = vnode.elm, oldClass = oldVnode.data.class, klass = vnode.data.class;\r\n    if (!oldClass && !klass)\r\n        return;\r\n    if (oldClass === klass)\r\n        return;\r\n    oldClass = oldClass || {};\r\n    klass = klass || {};\r\n    for (name in oldClass) {\r\n        if (!klass[name]) {\r\n            elm.classList.remove(name);\r\n        }\r\n    }\r\n    for (name in klass) {\r\n        cur = klass[name];\r\n        if (cur !== oldClass[name]) {\r\n            elm.classList[cur ? 'add' : 'remove'](name);\r\n        }\r\n    }\r\n}\r\nexports.classModule = { create: updateClass, update: updateClass };\r\nexports.default = exports.classModule;\r\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction invokeHandler(handler, vnode, event) {\r\n    if (typeof handler === \"function\") {\r\n        // call function handler\r\n        handler.call(vnode, event, vnode);\r\n    }\r\n    else if (typeof handler === \"object\") {\r\n        // call handler with arguments\r\n        if (typeof handler[0] === \"function\") {\r\n            // special case for single argument for performance\r\n            if (handler.length === 2) {\r\n                handler[0].call(vnode, handler[1], event, vnode);\r\n            }\r\n            else {\r\n                var args = handler.slice(1);\r\n                args.push(event);\r\n                args.push(vnode);\r\n                handler[0].apply(vnode, args);\r\n            }\r\n        }\r\n        else {\r\n            // call multiple handlers\r\n            for (var i = 0; i < handler.length; i++) {\r\n                invokeHandler(handler[i], vnode, event);\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction handleEvent(event, vnode) {\r\n    var name = event.type, on = vnode.data.on;\r\n    // call event handler(s) if exists\r\n    if (on && on[name]) {\r\n        invokeHandler(on[name], vnode, event);\r\n    }\r\n}\r\nfunction createListener() {\r\n    return function handler(event) {\r\n        handleEvent(event, handler.vnode);\r\n    };\r\n}\r\nfunction updateEventListeners(oldVnode, vnode) {\r\n    var oldOn = oldVnode.data.on, oldListener = oldVnode.listener, oldElm = oldVnode.elm, on = vnode && vnode.data.on, elm = (vnode && vnode.elm), name;\r\n    // optimization for reused immutable handlers\r\n    if (oldOn === on) {\r\n        return;\r\n    }\r\n    // remove existing listeners which no longer used\r\n    if (oldOn && oldListener) {\r\n        // if element changed or deleted we remove all existing listeners unconditionally\r\n        if (!on) {\r\n            for (name in oldOn) {\r\n                // remove listener if element was changed or existing listeners removed\r\n                oldElm.removeEventListener(name, oldListener, false);\r\n            }\r\n        }\r\n        else {\r\n            for (name in oldOn) {\r\n                // remove listener if existing listener removed\r\n                if (!on[name]) {\r\n                    oldElm.removeEventListener(name, oldListener, false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // add new listeners which has not already attached\r\n    if (on) {\r\n        // reuse existing listener or create new\r\n        var listener = vnode.listener = oldVnode.listener || createListener();\r\n        // update vnode for listener\r\n        listener.vnode = vnode;\r\n        // if element changed or added we add all needed listeners unconditionally\r\n        if (!oldOn) {\r\n            for (name in on) {\r\n                // add listener if element was changed or new listeners added\r\n                elm.addEventListener(name, listener, false);\r\n            }\r\n        }\r\n        else {\r\n            for (name in on) {\r\n                // add listener if new listener added\r\n                if (!oldOn[name]) {\r\n                    elm.addEventListener(name, listener, false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.eventListenersModule = {\r\n    create: updateEventListeners,\r\n    update: updateEventListeners,\r\n    destroy: updateEventListeners\r\n};\r\nexports.default = exports.eventListenersModule;\r\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction updateProps(oldVnode, vnode) {\r\n    var key, cur, old, elm = vnode.elm, oldProps = oldVnode.data.props, props = vnode.data.props;\r\n    if (!oldProps && !props)\r\n        return;\r\n    if (oldProps === props)\r\n        return;\r\n    oldProps = oldProps || {};\r\n    props = props || {};\r\n    for (key in oldProps) {\r\n        if (!props[key]) {\r\n            delete elm[key];\r\n        }\r\n    }\r\n    for (key in props) {\r\n        cur = props[key];\r\n        old = oldProps[key];\r\n        if (old !== cur && (key !== 'value' || elm[key] !== cur)) {\r\n            elm[key] = cur;\r\n        }\r\n    }\r\n}\r\nexports.propsModule = { create: updateProps, update: updateProps };\r\nexports.default = exports.propsModule;\r\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// Bindig `requestAnimationFrame` like this fixes a bug in IE/Edge. See #360 and #409.\r\nvar raf = (typeof window !== 'undefined' && (window.requestAnimationFrame).bind(window)) || setTimeout;\r\nvar nextFrame = function (fn) { raf(function () { raf(fn); }); };\r\nvar reflowForced = false;\r\nfunction setNextFrame(obj, prop, val) {\r\n    nextFrame(function () { obj[prop] = val; });\r\n}\r\nfunction updateStyle(oldVnode, vnode) {\r\n    var cur, name, elm = vnode.elm, oldStyle = oldVnode.data.style, style = vnode.data.style;\r\n    if (!oldStyle && !style)\r\n        return;\r\n    if (oldStyle === style)\r\n        return;\r\n    oldStyle = oldStyle || {};\r\n    style = style || {};\r\n    var oldHasDel = 'delayed' in oldStyle;\r\n    for (name in oldStyle) {\r\n        if (!style[name]) {\r\n            if (name[0] === '-' && name[1] === '-') {\r\n                elm.style.removeProperty(name);\r\n            }\r\n            else {\r\n                elm.style[name] = '';\r\n            }\r\n        }\r\n    }\r\n    for (name in style) {\r\n        cur = style[name];\r\n        if (name === 'delayed' && style.delayed) {\r\n            for (var name2 in style.delayed) {\r\n                cur = style.delayed[name2];\r\n                if (!oldHasDel || cur !== oldStyle.delayed[name2]) {\r\n                    setNextFrame(elm.style, name2, cur);\r\n                }\r\n            }\r\n        }\r\n        else if (name !== 'remove' && cur !== oldStyle[name]) {\r\n            if (name[0] === '-' && name[1] === '-') {\r\n                elm.style.setProperty(name, cur);\r\n            }\r\n            else {\r\n                elm.style[name] = cur;\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction applyDestroyStyle(vnode) {\r\n    var style, name, elm = vnode.elm, s = vnode.data.style;\r\n    if (!s || !(style = s.destroy))\r\n        return;\r\n    for (name in style) {\r\n        elm.style[name] = style[name];\r\n    }\r\n}\r\nfunction applyRemoveStyle(vnode, rm) {\r\n    var s = vnode.data.style;\r\n    if (!s || !s.remove) {\r\n        rm();\r\n        return;\r\n    }\r\n    if (!reflowForced) {\r\n        vnode.elm.offsetLeft;\r\n        reflowForced = true;\r\n    }\r\n    var name, elm = vnode.elm, i = 0, compStyle, style = s.remove, amount = 0, applied = [];\r\n    for (name in style) {\r\n        applied.push(name);\r\n        elm.style[name] = style[name];\r\n    }\r\n    compStyle = getComputedStyle(elm);\r\n    var props = compStyle['transition-property'].split(', ');\r\n    for (; i < props.length; ++i) {\r\n        if (applied.indexOf(props[i]) !== -1)\r\n            amount++;\r\n    }\r\n    elm.addEventListener('transitionend', function (ev) {\r\n        if (ev.target === elm)\r\n            --amount;\r\n        if (amount === 0)\r\n            rm();\r\n    });\r\n}\r\nfunction forceReflow() {\r\n    reflowForced = false;\r\n}\r\nexports.styleModule = {\r\n    pre: forceReflow,\r\n    create: updateStyle,\r\n    update: updateStyle,\r\n    destroy: applyDestroyStyle,\r\n    remove: applyRemoveStyle\r\n};\r\nexports.default = exports.styleModule;\r\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar snabbdom_1 = require(\"./snabbdom\");\r\nvar attributes_1 = require(\"./modules/attributes\"); // for setting attributes on DOM elements\r\nvar class_1 = require(\"./modules/class\"); // makes it easy to toggle classes\r\nvar props_1 = require(\"./modules/props\"); // for setting properties on DOM elements\r\nvar style_1 = require(\"./modules/style\"); // handles styling on elements with support for animations\r\nvar eventlisteners_1 = require(\"./modules/eventlisteners\"); // attaches event listeners\r\nvar h_1 = require(\"./h\"); // helper function for creating vnodes\r\nvar patch = snabbdom_1.init([\r\n    attributes_1.attributesModule,\r\n    class_1.classModule,\r\n    props_1.propsModule,\r\n    style_1.styleModule,\r\n    eventlisteners_1.eventListenersModule\r\n]);\r\nexports.snabbdomBundle = { patch: patch, h: h_1.h };\r\nexports.default = exports.snabbdomBundle;\r\n\n},{\"./h\":1,\"./modules/attributes\":4,\"./modules/class\":5,\"./modules/eventlisteners\":6,\"./modules/props\":7,\"./modules/style\":8,\"./snabbdom\":10}],10:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar vnode_1 = require(\"./vnode\");\r\nvar is = require(\"./is\");\r\nvar htmldomapi_1 = require(\"./htmldomapi\");\r\nfunction isUndef(s) { return s === undefined; }\r\nfunction isDef(s) { return s !== undefined; }\r\nvar emptyNode = vnode_1.default('', {}, [], undefined, undefined);\r\nfunction sameVnode(vnode1, vnode2) {\r\n    return vnode1.key === vnode2.key && vnode1.sel === vnode2.sel;\r\n}\r\nfunction isVnode(vnode) {\r\n    return vnode.sel !== undefined;\r\n}\r\nfunction createKeyToOldIdx(children, beginIdx, endIdx) {\r\n    var _a;\r\n    var map = {};\r\n    for (var i = beginIdx; i <= endIdx; ++i) {\r\n        var key = (_a = children[i]) === null || _a === void 0 ? void 0 : _a.key;\r\n        if (key !== undefined) {\r\n            map[key] = i;\r\n        }\r\n    }\r\n    return map;\r\n}\r\nvar hooks = ['create', 'update', 'remove', 'destroy', 'pre', 'post'];\r\nvar h_1 = require(\"./h\");\r\nexports.h = h_1.h;\r\nvar thunk_1 = require(\"./thunk\");\r\nexports.thunk = thunk_1.thunk;\r\nfunction init(modules, domApi) {\r\n    var i, j, cbs = {};\r\n    var api = domApi !== undefined ? domApi : htmldomapi_1.default;\r\n    for (i = 0; i < hooks.length; ++i) {\r\n        cbs[hooks[i]] = [];\r\n        for (j = 0; j < modules.length; ++j) {\r\n            var hook = modules[j][hooks[i]];\r\n            if (hook !== undefined) {\r\n                cbs[hooks[i]].push(hook);\r\n            }\r\n        }\r\n    }\r\n    function emptyNodeAt(elm) {\r\n        var id = elm.id ? '#' + elm.id : '';\r\n        var c = elm.className ? '.' + elm.className.split(' ').join('.') : '';\r\n        return vnode_1.default(api.tagName(elm).toLowerCase() + id + c, {}, [], undefined, elm);\r\n    }\r\n    function createRmCb(childElm, listeners) {\r\n        return function rmCb() {\r\n            if (--listeners === 0) {\r\n                var parent_1 = api.parentNode(childElm);\r\n                api.removeChild(parent_1, childElm);\r\n            }\r\n        };\r\n    }\r\n    function createElm(vnode, insertedVnodeQueue) {\r\n        var _a, _b, _c;\r\n        var i, data = vnode.data;\r\n        if (data !== undefined) {\r\n            var init_1 = (_a = data.hook) === null || _a === void 0 ? void 0 : _a.init;\r\n            if (isDef(init_1)) {\r\n                init_1(vnode);\r\n                data = vnode.data;\r\n            }\r\n        }\r\n        var children = vnode.children, sel = vnode.sel;\r\n        if (sel === '!') {\r\n            if (isUndef(vnode.text)) {\r\n                vnode.text = '';\r\n            }\r\n            vnode.elm = api.createComment(vnode.text);\r\n        }\r\n        else if (sel !== undefined) {\r\n            // Parse selector\r\n            var hashIdx = sel.indexOf('#');\r\n            var dotIdx = sel.indexOf('.', hashIdx);\r\n            var hash = hashIdx > 0 ? hashIdx : sel.length;\r\n            var dot = dotIdx > 0 ? dotIdx : sel.length;\r\n            var tag = hashIdx !== -1 || dotIdx !== -1 ? sel.slice(0, Math.min(hash, dot)) : sel;\r\n            var elm = vnode.elm = isDef(data) && isDef(i = data.ns)\r\n                ? api.createElementNS(i, tag)\r\n                : api.createElement(tag);\r\n            if (hash < dot)\r\n                elm.setAttribute('id', sel.slice(hash + 1, dot));\r\n            if (dotIdx > 0)\r\n                elm.setAttribute('class', sel.slice(dot + 1).replace(/\\./g, ' '));\r\n            for (i = 0; i < cbs.create.length; ++i)\r\n                cbs.create[i](emptyNode, vnode);\r\n            if (is.array(children)) {\r\n                for (i = 0; i < children.length; ++i) {\r\n                    var ch = children[i];\r\n                    if (ch != null) {\r\n                        api.appendChild(elm, createElm(ch, insertedVnodeQueue));\r\n                    }\r\n                }\r\n            }\r\n            else if (is.primitive(vnode.text)) {\r\n                api.appendChild(elm, api.createTextNode(vnode.text));\r\n            }\r\n            var hook = vnode.data.hook;\r\n            if (isDef(hook)) {\r\n                (_c = (_b = hook).create) === null || _c === void 0 ? void 0 : _c.call(_b, emptyNode, vnode);\r\n                if (hook.insert) {\r\n                    insertedVnodeQueue.push(vnode);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            vnode.elm = api.createTextNode(vnode.text);\r\n        }\r\n        return vnode.elm;\r\n    }\r\n    function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {\r\n        for (; startIdx <= endIdx; ++startIdx) {\r\n            var ch = vnodes[startIdx];\r\n            if (ch != null) {\r\n                api.insertBefore(parentElm, createElm(ch, insertedVnodeQueue), before);\r\n            }\r\n        }\r\n    }\r\n    function invokeDestroyHook(vnode) {\r\n        var _a, _b, _c, _d;\r\n        var data = vnode.data;\r\n        if (data !== undefined) {\r\n            (_d = (_b = (_a = data) === null || _a === void 0 ? void 0 : _a.hook) === null || _b === void 0 ? void 0 : (_c = _b).destroy) === null || _d === void 0 ? void 0 : _d.call(_c, vnode);\r\n            for (var i_1 = 0; i_1 < cbs.destroy.length; ++i_1)\r\n                cbs.destroy[i_1](vnode);\r\n            if (vnode.children !== undefined) {\r\n                for (var j_1 = 0; j_1 < vnode.children.length; ++j_1) {\r\n                    var child = vnode.children[j_1];\r\n                    if (child != null && typeof child !== \"string\") {\r\n                        invokeDestroyHook(child);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function removeVnodes(parentElm, vnodes, startIdx, endIdx) {\r\n        var _a, _b, _c;\r\n        for (; startIdx <= endIdx; ++startIdx) {\r\n            var listeners = void 0, rm = void 0, ch = vnodes[startIdx];\r\n            if (ch != null) {\r\n                if (isDef(ch.sel)) {\r\n                    invokeDestroyHook(ch);\r\n                    listeners = cbs.remove.length + 1;\r\n                    rm = createRmCb(ch.elm, listeners);\r\n                    for (var i_2 = 0; i_2 < cbs.remove.length; ++i_2)\r\n                        cbs.remove[i_2](ch, rm);\r\n                    var removeHook = (_c = (_b = (_a = ch) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b.hook) === null || _c === void 0 ? void 0 : _c.remove;\r\n                    if (isDef(removeHook)) {\r\n                        removeHook(ch, rm);\r\n                    }\r\n                    else {\r\n                        rm();\r\n                    }\r\n                }\r\n                else { // Text node\r\n                    api.removeChild(parentElm, ch.elm);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {\r\n        var oldStartIdx = 0, newStartIdx = 0;\r\n        var oldEndIdx = oldCh.length - 1;\r\n        var oldStartVnode = oldCh[0];\r\n        var oldEndVnode = oldCh[oldEndIdx];\r\n        var newEndIdx = newCh.length - 1;\r\n        var newStartVnode = newCh[0];\r\n        var newEndVnode = newCh[newEndIdx];\r\n        var oldKeyToIdx;\r\n        var idxInOld;\r\n        var elmToMove;\r\n        var before;\r\n        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\r\n            if (oldStartVnode == null) {\r\n                oldStartVnode = oldCh[++oldStartIdx]; // Vnode might have been moved left\r\n            }\r\n            else if (oldEndVnode == null) {\r\n                oldEndVnode = oldCh[--oldEndIdx];\r\n            }\r\n            else if (newStartVnode == null) {\r\n                newStartVnode = newCh[++newStartIdx];\r\n            }\r\n            else if (newEndVnode == null) {\r\n                newEndVnode = newCh[--newEndIdx];\r\n            }\r\n            else if (sameVnode(oldStartVnode, newStartVnode)) {\r\n                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);\r\n                oldStartVnode = oldCh[++oldStartIdx];\r\n                newStartVnode = newCh[++newStartIdx];\r\n            }\r\n            else if (sameVnode(oldEndVnode, newEndVnode)) {\r\n                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);\r\n                oldEndVnode = oldCh[--oldEndIdx];\r\n                newEndVnode = newCh[--newEndIdx];\r\n            }\r\n            else if (sameVnode(oldStartVnode, newEndVnode)) { // Vnode moved right\r\n                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);\r\n                api.insertBefore(parentElm, oldStartVnode.elm, api.nextSibling(oldEndVnode.elm));\r\n                oldStartVnode = oldCh[++oldStartIdx];\r\n                newEndVnode = newCh[--newEndIdx];\r\n            }\r\n            else if (sameVnode(oldEndVnode, newStartVnode)) { // Vnode moved left\r\n                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);\r\n                api.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);\r\n                oldEndVnode = oldCh[--oldEndIdx];\r\n                newStartVnode = newCh[++newStartIdx];\r\n            }\r\n            else {\r\n                if (oldKeyToIdx === undefined) {\r\n                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\r\n                }\r\n                idxInOld = oldKeyToIdx[newStartVnode.key];\r\n                if (isUndef(idxInOld)) { // New element\r\n                    api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\r\n                    newStartVnode = newCh[++newStartIdx];\r\n                }\r\n                else {\r\n                    elmToMove = oldCh[idxInOld];\r\n                    if (elmToMove.sel !== newStartVnode.sel) {\r\n                        api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\r\n                    }\r\n                    else {\r\n                        patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);\r\n                        oldCh[idxInOld] = undefined;\r\n                        api.insertBefore(parentElm, elmToMove.elm, oldStartVnode.elm);\r\n                    }\r\n                    newStartVnode = newCh[++newStartIdx];\r\n                }\r\n            }\r\n        }\r\n        if (oldStartIdx <= oldEndIdx || newStartIdx <= newEndIdx) {\r\n            if (oldStartIdx > oldEndIdx) {\r\n                before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;\r\n                addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\r\n            }\r\n            else {\r\n                removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\r\n            }\r\n        }\r\n    }\r\n    function patchVnode(oldVnode, vnode, insertedVnodeQueue) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n        var hook = (_a = vnode.data) === null || _a === void 0 ? void 0 : _a.hook;\r\n        (_d = (_b = hook) === null || _b === void 0 ? void 0 : (_c = _b).prepatch) === null || _d === void 0 ? void 0 : _d.call(_c, oldVnode, vnode);\r\n        var elm = vnode.elm = oldVnode.elm;\r\n        var oldCh = oldVnode.children;\r\n        var ch = vnode.children;\r\n        if (oldVnode === vnode)\r\n            return;\r\n        if (vnode.data !== undefined) {\r\n            for (var i_3 = 0; i_3 < cbs.update.length; ++i_3)\r\n                cbs.update[i_3](oldVnode, vnode);\r\n            (_g = (_e = vnode.data.hook) === null || _e === void 0 ? void 0 : (_f = _e).update) === null || _g === void 0 ? void 0 : _g.call(_f, oldVnode, vnode);\r\n        }\r\n        if (isUndef(vnode.text)) {\r\n            if (isDef(oldCh) && isDef(ch)) {\r\n                if (oldCh !== ch)\r\n                    updateChildren(elm, oldCh, ch, insertedVnodeQueue);\r\n            }\r\n            else if (isDef(ch)) {\r\n                if (isDef(oldVnode.text))\r\n                    api.setTextContent(elm, '');\r\n                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\r\n            }\r\n            else if (isDef(oldCh)) {\r\n                removeVnodes(elm, oldCh, 0, oldCh.length - 1);\r\n            }\r\n            else if (isDef(oldVnode.text)) {\r\n                api.setTextContent(elm, '');\r\n            }\r\n        }\r\n        else if (oldVnode.text !== vnode.text) {\r\n            if (isDef(oldCh)) {\r\n                removeVnodes(elm, oldCh, 0, oldCh.length - 1);\r\n            }\r\n            api.setTextContent(elm, vnode.text);\r\n        }\r\n        (_k = (_h = hook) === null || _h === void 0 ? void 0 : (_j = _h).postpatch) === null || _k === void 0 ? void 0 : _k.call(_j, oldVnode, vnode);\r\n    }\r\n    return function patch(oldVnode, vnode) {\r\n        var i, elm, parent;\r\n        var insertedVnodeQueue = [];\r\n        for (i = 0; i < cbs.pre.length; ++i)\r\n            cbs.pre[i]();\r\n        if (!isVnode(oldVnode)) {\r\n            oldVnode = emptyNodeAt(oldVnode);\r\n        }\r\n        if (sameVnode(oldVnode, vnode)) {\r\n            patchVnode(oldVnode, vnode, insertedVnodeQueue);\r\n        }\r\n        else {\r\n            elm = oldVnode.elm;\r\n            parent = api.parentNode(elm);\r\n            createElm(vnode, insertedVnodeQueue);\r\n            if (parent !== null) {\r\n                api.insertBefore(parent, vnode.elm, api.nextSibling(elm));\r\n                removeVnodes(parent, [oldVnode], 0, 0);\r\n            }\r\n        }\r\n        for (i = 0; i < insertedVnodeQueue.length; ++i) {\r\n            insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);\r\n        }\r\n        for (i = 0; i < cbs.post.length; ++i)\r\n            cbs.post[i]();\r\n        return vnode;\r\n    };\r\n}\r\nexports.init = init;\r\n\n},{\"./h\":1,\"./htmldomapi\":2,\"./is\":3,\"./thunk\":11,\"./vnode\":12}],11:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar h_1 = require(\"./h\");\r\nfunction copyToThunk(vnode, thunk) {\r\n    thunk.elm = vnode.elm;\r\n    vnode.data.fn = thunk.data.fn;\r\n    vnode.data.args = thunk.data.args;\r\n    thunk.data = vnode.data;\r\n    thunk.children = vnode.children;\r\n    thunk.text = vnode.text;\r\n    thunk.elm = vnode.elm;\r\n}\r\nfunction init(thunk) {\r\n    var cur = thunk.data;\r\n    var vnode = cur.fn.apply(undefined, cur.args);\r\n    copyToThunk(vnode, thunk);\r\n}\r\nfunction prepatch(oldVnode, thunk) {\r\n    var i, old = oldVnode.data, cur = thunk.data;\r\n    var oldArgs = old.args, args = cur.args;\r\n    if (old.fn !== cur.fn || oldArgs.length !== args.length) {\r\n        copyToThunk(cur.fn.apply(undefined, args), thunk);\r\n        return;\r\n    }\r\n    for (i = 0; i < args.length; ++i) {\r\n        if (oldArgs[i] !== args[i]) {\r\n            copyToThunk(cur.fn.apply(undefined, args), thunk);\r\n            return;\r\n        }\r\n    }\r\n    copyToThunk(oldVnode, thunk);\r\n}\r\nexports.thunk = function thunk(sel, key, fn, args) {\r\n    if (args === undefined) {\r\n        args = fn;\r\n        fn = key;\r\n        key = undefined;\r\n    }\r\n    return h_1.h(sel, {\r\n        key: key,\r\n        hook: { init: init, prepatch: prepatch },\r\n        fn: fn,\r\n        args: args\r\n    });\r\n};\r\nexports.default = exports.thunk;\r\n\n},{\"./h\":1}],12:[function(require,module,exports){\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction vnode(sel, data, children, text, elm) {\r\n    var key = data === undefined ? undefined : data.key;\r\n    return { sel: sel, data: data, children: children, text: text, elm: elm, key: key };\r\n}\r\nexports.vnode = vnode;\r\nexports.default = vnode;\r\n\n},{}]},{},[9])(9)\n});\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJoLmpzIiwiaHRtbGRvbWFwaS5qcyIsImlzLmpzIiwibW9kdWxlcy9hdHRyaWJ1dGVzLmpzIiwibW9kdWxlcy9jbGFzcy5qcyIsIm1vZHVsZXMvZXZlbnRsaXN0ZW5lcnMuanMiLCJtb2R1bGVzL3Byb3BzLmpzIiwibW9kdWxlcy9zdHlsZS5qcyIsInNuYWJiZG9tLmJ1bmRsZS5qcyIsInNuYWJiZG9tLmpzIiwidGh1bmsuanMiLCJ2bm9kZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgdm5vZGVfMSA9IHJlcXVpcmUoXCIuL3Zub2RlXCIpO1xyXG52YXIgaXMgPSByZXF1aXJlKFwiLi9pc1wiKTtcclxuZnVuY3Rpb24gYWRkTlMoZGF0YSwgY2hpbGRyZW4sIHNlbCkge1xyXG4gICAgZGF0YS5ucyA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XHJcbiAgICBpZiAoc2VsICE9PSAnZm9yZWlnbk9iamVjdCcgJiYgY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkRGF0YSA9IGNoaWxkcmVuW2ldLmRhdGE7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZERhdGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgYWRkTlMoY2hpbGREYXRhLCBjaGlsZHJlbltpXS5jaGlsZHJlbiwgY2hpbGRyZW5baV0uc2VsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoKHNlbCwgYiwgYykge1xyXG4gICAgdmFyIGRhdGEgPSB7fSwgY2hpbGRyZW4sIHRleHQsIGk7XHJcbiAgICBpZiAoYyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgaWYgKGIgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgZGF0YSA9IGI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpcy5hcnJheShjKSkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGlzLnByaW1pdGl2ZShjKSkge1xyXG4gICAgICAgICAgICB0ZXh0ID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyAmJiBjLnNlbCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IFtjXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChiICE9PSB1bmRlZmluZWQgJiYgYiAhPT0gbnVsbCkge1xyXG4gICAgICAgIGlmIChpcy5hcnJheShiKSkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IGI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGlzLnByaW1pdGl2ZShiKSkge1xyXG4gICAgICAgICAgICB0ZXh0ID0gYjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYiAmJiBiLnNlbCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IFtiXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChjaGlsZHJlbiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChpcy5wcmltaXRpdmUoY2hpbGRyZW5baV0pKVxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW5baV0gPSB2bm9kZV8xLnZub2RlKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNoaWxkcmVuW2ldLCB1bmRlZmluZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChzZWxbMF0gPT09ICdzJyAmJiBzZWxbMV0gPT09ICd2JyAmJiBzZWxbMl0gPT09ICdnJyAmJlxyXG4gICAgICAgIChzZWwubGVuZ3RoID09PSAzIHx8IHNlbFszXSA9PT0gJy4nIHx8IHNlbFszXSA9PT0gJyMnKSkge1xyXG4gICAgICAgIGFkZE5TKGRhdGEsIGNoaWxkcmVuLCBzZWwpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZub2RlXzEudm5vZGUoc2VsLCBkYXRhLCBjaGlsZHJlbiwgdGV4dCwgdW5kZWZpbmVkKTtcclxufVxyXG5leHBvcnRzLmggPSBoO1xyXG47XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGg7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWguanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZnVuY3Rpb24gY3JlYXRlRWxlbWVudCh0YWdOYW1lKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlVVJJLCBxdWFsaWZpZWROYW1lKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZVVSSSwgcXVhbGlmaWVkTmFtZSk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlVGV4dE5vZGUodGV4dCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRleHQpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUNvbW1lbnQodGV4dCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQodGV4dCk7XHJcbn1cclxuZnVuY3Rpb24gaW5zZXJ0QmVmb3JlKHBhcmVudE5vZGUsIG5ld05vZGUsIHJlZmVyZW5jZU5vZGUpIHtcclxuICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld05vZGUsIHJlZmVyZW5jZU5vZGUpO1xyXG59XHJcbmZ1bmN0aW9uIHJlbW92ZUNoaWxkKG5vZGUsIGNoaWxkKSB7XHJcbiAgICBub2RlLnJlbW92ZUNoaWxkKGNoaWxkKTtcclxufVxyXG5mdW5jdGlvbiBhcHBlbmRDaGlsZChub2RlLCBjaGlsZCkge1xyXG4gICAgbm9kZS5hcHBlbmRDaGlsZChjaGlsZCk7XHJcbn1cclxuZnVuY3Rpb24gcGFyZW50Tm9kZShub2RlKSB7XHJcbiAgICByZXR1cm4gbm9kZS5wYXJlbnROb2RlO1xyXG59XHJcbmZ1bmN0aW9uIG5leHRTaWJsaW5nKG5vZGUpIHtcclxuICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nO1xyXG59XHJcbmZ1bmN0aW9uIHRhZ05hbWUoZWxtKSB7XHJcbiAgICByZXR1cm4gZWxtLnRhZ05hbWU7XHJcbn1cclxuZnVuY3Rpb24gc2V0VGV4dENvbnRlbnQobm9kZSwgdGV4dCkge1xyXG4gICAgbm9kZS50ZXh0Q29udGVudCA9IHRleHQ7XHJcbn1cclxuZnVuY3Rpb24gZ2V0VGV4dENvbnRlbnQobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUudGV4dENvbnRlbnQ7XHJcbn1cclxuZnVuY3Rpb24gaXNFbGVtZW50KG5vZGUpIHtcclxuICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSAxO1xyXG59XHJcbmZ1bmN0aW9uIGlzVGV4dChub2RlKSB7XHJcbiAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gMztcclxufVxyXG5mdW5jdGlvbiBpc0NvbW1lbnQobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDg7XHJcbn1cclxuZXhwb3J0cy5odG1sRG9tQXBpID0ge1xyXG4gICAgY3JlYXRlRWxlbWVudDogY3JlYXRlRWxlbWVudCxcclxuICAgIGNyZWF0ZUVsZW1lbnROUzogY3JlYXRlRWxlbWVudE5TLFxyXG4gICAgY3JlYXRlVGV4dE5vZGU6IGNyZWF0ZVRleHROb2RlLFxyXG4gICAgY3JlYXRlQ29tbWVudDogY3JlYXRlQ29tbWVudCxcclxuICAgIGluc2VydEJlZm9yZTogaW5zZXJ0QmVmb3JlLFxyXG4gICAgcmVtb3ZlQ2hpbGQ6IHJlbW92ZUNoaWxkLFxyXG4gICAgYXBwZW5kQ2hpbGQ6IGFwcGVuZENoaWxkLFxyXG4gICAgcGFyZW50Tm9kZTogcGFyZW50Tm9kZSxcclxuICAgIG5leHRTaWJsaW5nOiBuZXh0U2libGluZyxcclxuICAgIHRhZ05hbWU6IHRhZ05hbWUsXHJcbiAgICBzZXRUZXh0Q29udGVudDogc2V0VGV4dENvbnRlbnQsXHJcbiAgICBnZXRUZXh0Q29udGVudDogZ2V0VGV4dENvbnRlbnQsXHJcbiAgICBpc0VsZW1lbnQ6IGlzRWxlbWVudCxcclxuICAgIGlzVGV4dDogaXNUZXh0LFxyXG4gICAgaXNDb21tZW50OiBpc0NvbW1lbnQsXHJcbn07XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMuaHRtbERvbUFwaTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHRtbGRvbWFwaS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmFycmF5ID0gQXJyYXkuaXNBcnJheTtcclxuZnVuY3Rpb24gcHJpbWl0aXZlKHMpIHtcclxuICAgIHJldHVybiB0eXBlb2YgcyA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHMgPT09ICdudW1iZXInO1xyXG59XHJcbmV4cG9ydHMucHJpbWl0aXZlID0gcHJpbWl0aXZlO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pcy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgeGxpbmtOUyA9ICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJztcclxudmFyIHhtbE5TID0gJ2h0dHA6Ly93d3cudzMub3JnL1hNTC8xOTk4L25hbWVzcGFjZSc7XHJcbnZhciBjb2xvbkNoYXIgPSA1ODtcclxudmFyIHhDaGFyID0gMTIwO1xyXG5mdW5jdGlvbiB1cGRhdGVBdHRycyhvbGRWbm9kZSwgdm5vZGUpIHtcclxuICAgIHZhciBrZXksIGVsbSA9IHZub2RlLmVsbSwgb2xkQXR0cnMgPSBvbGRWbm9kZS5kYXRhLmF0dHJzLCBhdHRycyA9IHZub2RlLmRhdGEuYXR0cnM7XHJcbiAgICBpZiAoIW9sZEF0dHJzICYmICFhdHRycylcclxuICAgICAgICByZXR1cm47XHJcbiAgICBpZiAob2xkQXR0cnMgPT09IGF0dHJzKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIG9sZEF0dHJzID0gb2xkQXR0cnMgfHwge307XHJcbiAgICBhdHRycyA9IGF0dHJzIHx8IHt9O1xyXG4gICAgLy8gdXBkYXRlIG1vZGlmaWVkIGF0dHJpYnV0ZXMsIGFkZCBuZXcgYXR0cmlidXRlc1xyXG4gICAgZm9yIChrZXkgaW4gYXR0cnMpIHtcclxuICAgICAgICB2YXIgY3VyID0gYXR0cnNba2V5XTtcclxuICAgICAgICB2YXIgb2xkID0gb2xkQXR0cnNba2V5XTtcclxuICAgICAgICBpZiAob2xkICE9PSBjdXIpIHtcclxuICAgICAgICAgICAgaWYgKGN1ciA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZShrZXksIFwiXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN1ciA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGVsbS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChrZXkuY2hhckNvZGVBdCgwKSAhPT0geENoYXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgY3VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGtleS5jaGFyQ29kZUF0KDMpID09PSBjb2xvbkNoYXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBBc3N1bWUgeG1sIG5hbWVzcGFjZVxyXG4gICAgICAgICAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGVOUyh4bWxOUywga2V5LCBjdXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5LmNoYXJDb2RlQXQoNSkgPT09IGNvbG9uQ2hhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFzc3VtZSB4bGluayBuYW1lc3BhY2VcclxuICAgICAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlTlMoeGxpbmtOUywga2V5LCBjdXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZShrZXksIGN1cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyByZW1vdmUgcmVtb3ZlZCBhdHRyaWJ1dGVzXHJcbiAgICAvLyB1c2UgYGluYCBvcGVyYXRvciBzaW5jZSB0aGUgcHJldmlvdXMgYGZvcmAgaXRlcmF0aW9uIHVzZXMgaXQgKC5pLmUuIGFkZCBldmVuIGF0dHJpYnV0ZXMgd2l0aCB1bmRlZmluZWQgdmFsdWUpXHJcbiAgICAvLyB0aGUgb3RoZXIgb3B0aW9uIGlzIHRvIHJlbW92ZSBhbGwgYXR0cmlidXRlcyB3aXRoIHZhbHVlID09IHVuZGVmaW5lZFxyXG4gICAgZm9yIChrZXkgaW4gb2xkQXR0cnMpIHtcclxuICAgICAgICBpZiAoIShrZXkgaW4gYXR0cnMpKSB7XHJcbiAgICAgICAgICAgIGVsbS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5hdHRyaWJ1dGVzTW9kdWxlID0geyBjcmVhdGU6IHVwZGF0ZUF0dHJzLCB1cGRhdGU6IHVwZGF0ZUF0dHJzIH07XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMuYXR0cmlidXRlc01vZHVsZTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXR0cmlidXRlcy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5mdW5jdGlvbiB1cGRhdGVDbGFzcyhvbGRWbm9kZSwgdm5vZGUpIHtcclxuICAgIHZhciBjdXIsIG5hbWUsIGVsbSA9IHZub2RlLmVsbSwgb2xkQ2xhc3MgPSBvbGRWbm9kZS5kYXRhLmNsYXNzLCBrbGFzcyA9IHZub2RlLmRhdGEuY2xhc3M7XHJcbiAgICBpZiAoIW9sZENsYXNzICYmICFrbGFzcylcclxuICAgICAgICByZXR1cm47XHJcbiAgICBpZiAob2xkQ2xhc3MgPT09IGtsYXNzKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIG9sZENsYXNzID0gb2xkQ2xhc3MgfHwge307XHJcbiAgICBrbGFzcyA9IGtsYXNzIHx8IHt9O1xyXG4gICAgZm9yIChuYW1lIGluIG9sZENsYXNzKSB7XHJcbiAgICAgICAgaWYgKCFrbGFzc1tuYW1lXSkge1xyXG4gICAgICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKG5hbWUgaW4ga2xhc3MpIHtcclxuICAgICAgICBjdXIgPSBrbGFzc1tuYW1lXTtcclxuICAgICAgICBpZiAoY3VyICE9PSBvbGRDbGFzc1tuYW1lXSkge1xyXG4gICAgICAgICAgICBlbG0uY2xhc3NMaXN0W2N1ciA/ICdhZGQnIDogJ3JlbW92ZSddKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5leHBvcnRzLmNsYXNzTW9kdWxlID0geyBjcmVhdGU6IHVwZGF0ZUNsYXNzLCB1cGRhdGU6IHVwZGF0ZUNsYXNzIH07XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMuY2xhc3NNb2R1bGU7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNsYXNzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmZ1bmN0aW9uIGludm9rZUhhbmRsZXIoaGFuZGxlciwgdm5vZGUsIGV2ZW50KSB7XHJcbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgIC8vIGNhbGwgZnVuY3Rpb24gaGFuZGxlclxyXG4gICAgICAgIGhhbmRsZXIuY2FsbCh2bm9kZSwgZXZlbnQsIHZub2RlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgLy8gY2FsbCBoYW5kbGVyIHdpdGggYXJndW1lbnRzXHJcbiAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyWzBdID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgLy8gc3BlY2lhbCBjYXNlIGZvciBzaW5nbGUgYXJndW1lbnQgZm9yIHBlcmZvcm1hbmNlXHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLmxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlclswXS5jYWxsKHZub2RlLCBoYW5kbGVyWzFdLCBldmVudCwgdm5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBoYW5kbGVyLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyWzBdLmFwcGx5KHZub2RlLCBhcmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gY2FsbCBtdWx0aXBsZSBoYW5kbGVyc1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbmRsZXIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGludm9rZUhhbmRsZXIoaGFuZGxlcltpXSwgdm5vZGUsIGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYW5kbGVFdmVudChldmVudCwgdm5vZGUpIHtcclxuICAgIHZhciBuYW1lID0gZXZlbnQudHlwZSwgb24gPSB2bm9kZS5kYXRhLm9uO1xyXG4gICAgLy8gY2FsbCBldmVudCBoYW5kbGVyKHMpIGlmIGV4aXN0c1xyXG4gICAgaWYgKG9uICYmIG9uW25hbWVdKSB7XHJcbiAgICAgICAgaW52b2tlSGFuZGxlcihvbltuYW1lXSwgdm5vZGUsIGV2ZW50KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVMaXN0ZW5lcigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7XHJcbiAgICAgICAgaGFuZGxlRXZlbnQoZXZlbnQsIGhhbmRsZXIudm5vZGUpO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVFdmVudExpc3RlbmVycyhvbGRWbm9kZSwgdm5vZGUpIHtcclxuICAgIHZhciBvbGRPbiA9IG9sZFZub2RlLmRhdGEub24sIG9sZExpc3RlbmVyID0gb2xkVm5vZGUubGlzdGVuZXIsIG9sZEVsbSA9IG9sZFZub2RlLmVsbSwgb24gPSB2bm9kZSAmJiB2bm9kZS5kYXRhLm9uLCBlbG0gPSAodm5vZGUgJiYgdm5vZGUuZWxtKSwgbmFtZTtcclxuICAgIC8vIG9wdGltaXphdGlvbiBmb3IgcmV1c2VkIGltbXV0YWJsZSBoYW5kbGVyc1xyXG4gICAgaWYgKG9sZE9uID09PSBvbikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8vIHJlbW92ZSBleGlzdGluZyBsaXN0ZW5lcnMgd2hpY2ggbm8gbG9uZ2VyIHVzZWRcclxuICAgIGlmIChvbGRPbiAmJiBvbGRMaXN0ZW5lcikge1xyXG4gICAgICAgIC8vIGlmIGVsZW1lbnQgY2hhbmdlZCBvciBkZWxldGVkIHdlIHJlbW92ZSBhbGwgZXhpc3RpbmcgbGlzdGVuZXJzIHVuY29uZGl0aW9uYWxseVxyXG4gICAgICAgIGlmICghb24pIHtcclxuICAgICAgICAgICAgZm9yIChuYW1lIGluIG9sZE9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXIgaWYgZWxlbWVudCB3YXMgY2hhbmdlZCBvciBleGlzdGluZyBsaXN0ZW5lcnMgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgb2xkRWxtLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgb2xkTGlzdGVuZXIsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChuYW1lIGluIG9sZE9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXIgaWYgZXhpc3RpbmcgbGlzdGVuZXIgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgaWYgKCFvbltuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9sZEVsbS5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsIG9sZExpc3RlbmVyLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBhZGQgbmV3IGxpc3RlbmVycyB3aGljaCBoYXMgbm90IGFscmVhZHkgYXR0YWNoZWRcclxuICAgIGlmIChvbikge1xyXG4gICAgICAgIC8vIHJldXNlIGV4aXN0aW5nIGxpc3RlbmVyIG9yIGNyZWF0ZSBuZXdcclxuICAgICAgICB2YXIgbGlzdGVuZXIgPSB2bm9kZS5saXN0ZW5lciA9IG9sZFZub2RlLmxpc3RlbmVyIHx8IGNyZWF0ZUxpc3RlbmVyKCk7XHJcbiAgICAgICAgLy8gdXBkYXRlIHZub2RlIGZvciBsaXN0ZW5lclxyXG4gICAgICAgIGxpc3RlbmVyLnZub2RlID0gdm5vZGU7XHJcbiAgICAgICAgLy8gaWYgZWxlbWVudCBjaGFuZ2VkIG9yIGFkZGVkIHdlIGFkZCBhbGwgbmVlZGVkIGxpc3RlbmVycyB1bmNvbmRpdGlvbmFsbHlcclxuICAgICAgICBpZiAoIW9sZE9uKSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGlmIGVsZW1lbnQgd2FzIGNoYW5nZWQgb3IgbmV3IGxpc3RlbmVycyBhZGRlZFxyXG4gICAgICAgICAgICAgICAgZWxtLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgbGlzdGVuZXIsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChuYW1lIGluIG9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgbGlzdGVuZXIgaWYgbmV3IGxpc3RlbmVyIGFkZGVkXHJcbiAgICAgICAgICAgICAgICBpZiAoIW9sZE9uW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLmFkZEV2ZW50TGlzdGVuZXIobmFtZSwgbGlzdGVuZXIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5leHBvcnRzLmV2ZW50TGlzdGVuZXJzTW9kdWxlID0ge1xyXG4gICAgY3JlYXRlOiB1cGRhdGVFdmVudExpc3RlbmVycyxcclxuICAgIHVwZGF0ZTogdXBkYXRlRXZlbnRMaXN0ZW5lcnMsXHJcbiAgICBkZXN0cm95OiB1cGRhdGVFdmVudExpc3RlbmVyc1xyXG59O1xyXG5leHBvcnRzLmRlZmF1bHQgPSBleHBvcnRzLmV2ZW50TGlzdGVuZXJzTW9kdWxlO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1ldmVudGxpc3RlbmVycy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5mdW5jdGlvbiB1cGRhdGVQcm9wcyhvbGRWbm9kZSwgdm5vZGUpIHtcclxuICAgIHZhciBrZXksIGN1ciwgb2xkLCBlbG0gPSB2bm9kZS5lbG0sIG9sZFByb3BzID0gb2xkVm5vZGUuZGF0YS5wcm9wcywgcHJvcHMgPSB2bm9kZS5kYXRhLnByb3BzO1xyXG4gICAgaWYgKCFvbGRQcm9wcyAmJiAhcHJvcHMpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKG9sZFByb3BzID09PSBwcm9wcylcclxuICAgICAgICByZXR1cm47XHJcbiAgICBvbGRQcm9wcyA9IG9sZFByb3BzIHx8IHt9O1xyXG4gICAgcHJvcHMgPSBwcm9wcyB8fCB7fTtcclxuICAgIGZvciAoa2V5IGluIG9sZFByb3BzKSB7XHJcbiAgICAgICAgaWYgKCFwcm9wc1trZXldKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBlbG1ba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKGtleSBpbiBwcm9wcykge1xyXG4gICAgICAgIGN1ciA9IHByb3BzW2tleV07XHJcbiAgICAgICAgb2xkID0gb2xkUHJvcHNba2V5XTtcclxuICAgICAgICBpZiAob2xkICE9PSBjdXIgJiYgKGtleSAhPT0gJ3ZhbHVlJyB8fCBlbG1ba2V5XSAhPT0gY3VyKSkge1xyXG4gICAgICAgICAgICBlbG1ba2V5XSA9IGN1cjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5wcm9wc01vZHVsZSA9IHsgY3JlYXRlOiB1cGRhdGVQcm9wcywgdXBkYXRlOiB1cGRhdGVQcm9wcyB9O1xyXG5leHBvcnRzLmRlZmF1bHQgPSBleHBvcnRzLnByb3BzTW9kdWxlO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9wcy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4vLyBCaW5kaWcgYHJlcXVlc3RBbmltYXRpb25GcmFtZWAgbGlrZSB0aGlzIGZpeGVzIGEgYnVnIGluIElFL0VkZ2UuIFNlZSAjMzYwIGFuZCAjNDA5LlxyXG52YXIgcmFmID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICh3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKS5iaW5kKHdpbmRvdykpIHx8IHNldFRpbWVvdXQ7XHJcbnZhciBuZXh0RnJhbWUgPSBmdW5jdGlvbiAoZm4pIHsgcmFmKGZ1bmN0aW9uICgpIHsgcmFmKGZuKTsgfSk7IH07XHJcbnZhciByZWZsb3dGb3JjZWQgPSBmYWxzZTtcclxuZnVuY3Rpb24gc2V0TmV4dEZyYW1lKG9iaiwgcHJvcCwgdmFsKSB7XHJcbiAgICBuZXh0RnJhbWUoZnVuY3Rpb24gKCkgeyBvYmpbcHJvcF0gPSB2YWw7IH0pO1xyXG59XHJcbmZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG9sZFZub2RlLCB2bm9kZSkge1xyXG4gICAgdmFyIGN1ciwgbmFtZSwgZWxtID0gdm5vZGUuZWxtLCBvbGRTdHlsZSA9IG9sZFZub2RlLmRhdGEuc3R5bGUsIHN0eWxlID0gdm5vZGUuZGF0YS5zdHlsZTtcclxuICAgIGlmICghb2xkU3R5bGUgJiYgIXN0eWxlKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmIChvbGRTdHlsZSA9PT0gc3R5bGUpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgb2xkU3R5bGUgPSBvbGRTdHlsZSB8fCB7fTtcclxuICAgIHN0eWxlID0gc3R5bGUgfHwge307XHJcbiAgICB2YXIgb2xkSGFzRGVsID0gJ2RlbGF5ZWQnIGluIG9sZFN0eWxlO1xyXG4gICAgZm9yIChuYW1lIGluIG9sZFN0eWxlKSB7XHJcbiAgICAgICAgaWYgKCFzdHlsZVtuYW1lXSkge1xyXG4gICAgICAgICAgICBpZiAobmFtZVswXSA9PT0gJy0nICYmIG5hbWVbMV0gPT09ICctJykge1xyXG4gICAgICAgICAgICAgICAgZWxtLnN0eWxlLnJlbW92ZVByb3BlcnR5KG5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWxtLnN0eWxlW25hbWVdID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKG5hbWUgaW4gc3R5bGUpIHtcclxuICAgICAgICBjdXIgPSBzdHlsZVtuYW1lXTtcclxuICAgICAgICBpZiAobmFtZSA9PT0gJ2RlbGF5ZWQnICYmIHN0eWxlLmRlbGF5ZWQpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgbmFtZTIgaW4gc3R5bGUuZGVsYXllZCkge1xyXG4gICAgICAgICAgICAgICAgY3VyID0gc3R5bGUuZGVsYXllZFtuYW1lMl07XHJcbiAgICAgICAgICAgICAgICBpZiAoIW9sZEhhc0RlbCB8fCBjdXIgIT09IG9sZFN0eWxlLmRlbGF5ZWRbbmFtZTJdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0TmV4dEZyYW1lKGVsbS5zdHlsZSwgbmFtZTIsIGN1cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobmFtZSAhPT0gJ3JlbW92ZScgJiYgY3VyICE9PSBvbGRTdHlsZVtuYW1lXSkge1xyXG4gICAgICAgICAgICBpZiAobmFtZVswXSA9PT0gJy0nICYmIG5hbWVbMV0gPT09ICctJykge1xyXG4gICAgICAgICAgICAgICAgZWxtLnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIGN1cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlbG0uc3R5bGVbbmFtZV0gPSBjdXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gYXBwbHlEZXN0cm95U3R5bGUodm5vZGUpIHtcclxuICAgIHZhciBzdHlsZSwgbmFtZSwgZWxtID0gdm5vZGUuZWxtLCBzID0gdm5vZGUuZGF0YS5zdHlsZTtcclxuICAgIGlmICghcyB8fCAhKHN0eWxlID0gcy5kZXN0cm95KSlcclxuICAgICAgICByZXR1cm47XHJcbiAgICBmb3IgKG5hbWUgaW4gc3R5bGUpIHtcclxuICAgICAgICBlbG0uc3R5bGVbbmFtZV0gPSBzdHlsZVtuYW1lXTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhcHBseVJlbW92ZVN0eWxlKHZub2RlLCBybSkge1xyXG4gICAgdmFyIHMgPSB2bm9kZS5kYXRhLnN0eWxlO1xyXG4gICAgaWYgKCFzIHx8ICFzLnJlbW92ZSkge1xyXG4gICAgICAgIHJtKCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCFyZWZsb3dGb3JjZWQpIHtcclxuICAgICAgICB2bm9kZS5lbG0ub2Zmc2V0TGVmdDtcclxuICAgICAgICByZWZsb3dGb3JjZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgdmFyIG5hbWUsIGVsbSA9IHZub2RlLmVsbSwgaSA9IDAsIGNvbXBTdHlsZSwgc3R5bGUgPSBzLnJlbW92ZSwgYW1vdW50ID0gMCwgYXBwbGllZCA9IFtdO1xyXG4gICAgZm9yIChuYW1lIGluIHN0eWxlKSB7XHJcbiAgICAgICAgYXBwbGllZC5wdXNoKG5hbWUpO1xyXG4gICAgICAgIGVsbS5zdHlsZVtuYW1lXSA9IHN0eWxlW25hbWVdO1xyXG4gICAgfVxyXG4gICAgY29tcFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbG0pO1xyXG4gICAgdmFyIHByb3BzID0gY29tcFN0eWxlWyd0cmFuc2l0aW9uLXByb3BlcnR5J10uc3BsaXQoJywgJyk7XHJcbiAgICBmb3IgKDsgaSA8IHByb3BzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgaWYgKGFwcGxpZWQuaW5kZXhPZihwcm9wc1tpXSkgIT09IC0xKVxyXG4gICAgICAgICAgICBhbW91bnQrKztcclxuICAgIH1cclxuICAgIGVsbS5hZGRFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24gKGV2KSB7XHJcbiAgICAgICAgaWYgKGV2LnRhcmdldCA9PT0gZWxtKVxyXG4gICAgICAgICAgICAtLWFtb3VudDtcclxuICAgICAgICBpZiAoYW1vdW50ID09PSAwKVxyXG4gICAgICAgICAgICBybSgpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gZm9yY2VSZWZsb3coKSB7XHJcbiAgICByZWZsb3dGb3JjZWQgPSBmYWxzZTtcclxufVxyXG5leHBvcnRzLnN0eWxlTW9kdWxlID0ge1xyXG4gICAgcHJlOiBmb3JjZVJlZmxvdyxcclxuICAgIGNyZWF0ZTogdXBkYXRlU3R5bGUsXHJcbiAgICB1cGRhdGU6IHVwZGF0ZVN0eWxlLFxyXG4gICAgZGVzdHJveTogYXBwbHlEZXN0cm95U3R5bGUsXHJcbiAgICByZW1vdmU6IGFwcGx5UmVtb3ZlU3R5bGVcclxufTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gZXhwb3J0cy5zdHlsZU1vZHVsZTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3R5bGUuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIHNuYWJiZG9tXzEgPSByZXF1aXJlKFwiLi9zbmFiYmRvbVwiKTtcclxudmFyIGF0dHJpYnV0ZXNfMSA9IHJlcXVpcmUoXCIuL21vZHVsZXMvYXR0cmlidXRlc1wiKTsgLy8gZm9yIHNldHRpbmcgYXR0cmlidXRlcyBvbiBET00gZWxlbWVudHNcclxudmFyIGNsYXNzXzEgPSByZXF1aXJlKFwiLi9tb2R1bGVzL2NsYXNzXCIpOyAvLyBtYWtlcyBpdCBlYXN5IHRvIHRvZ2dsZSBjbGFzc2VzXHJcbnZhciBwcm9wc18xID0gcmVxdWlyZShcIi4vbW9kdWxlcy9wcm9wc1wiKTsgLy8gZm9yIHNldHRpbmcgcHJvcGVydGllcyBvbiBET00gZWxlbWVudHNcclxudmFyIHN0eWxlXzEgPSByZXF1aXJlKFwiLi9tb2R1bGVzL3N0eWxlXCIpOyAvLyBoYW5kbGVzIHN0eWxpbmcgb24gZWxlbWVudHMgd2l0aCBzdXBwb3J0IGZvciBhbmltYXRpb25zXHJcbnZhciBldmVudGxpc3RlbmVyc18xID0gcmVxdWlyZShcIi4vbW9kdWxlcy9ldmVudGxpc3RlbmVyc1wiKTsgLy8gYXR0YWNoZXMgZXZlbnQgbGlzdGVuZXJzXHJcbnZhciBoXzEgPSByZXF1aXJlKFwiLi9oXCIpOyAvLyBoZWxwZXIgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIHZub2Rlc1xyXG52YXIgcGF0Y2ggPSBzbmFiYmRvbV8xLmluaXQoW1xyXG4gICAgYXR0cmlidXRlc18xLmF0dHJpYnV0ZXNNb2R1bGUsXHJcbiAgICBjbGFzc18xLmNsYXNzTW9kdWxlLFxyXG4gICAgcHJvcHNfMS5wcm9wc01vZHVsZSxcclxuICAgIHN0eWxlXzEuc3R5bGVNb2R1bGUsXHJcbiAgICBldmVudGxpc3RlbmVyc18xLmV2ZW50TGlzdGVuZXJzTW9kdWxlXHJcbl0pO1xyXG5leHBvcnRzLnNuYWJiZG9tQnVuZGxlID0geyBwYXRjaDogcGF0Y2gsIGg6IGhfMS5oIH07XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMuc25hYmJkb21CdW5kbGU7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNuYWJiZG9tLmJ1bmRsZS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgdm5vZGVfMSA9IHJlcXVpcmUoXCIuL3Zub2RlXCIpO1xyXG52YXIgaXMgPSByZXF1aXJlKFwiLi9pc1wiKTtcclxudmFyIGh0bWxkb21hcGlfMSA9IHJlcXVpcmUoXCIuL2h0bWxkb21hcGlcIik7XHJcbmZ1bmN0aW9uIGlzVW5kZWYocykgeyByZXR1cm4gcyA9PT0gdW5kZWZpbmVkOyB9XHJcbmZ1bmN0aW9uIGlzRGVmKHMpIHsgcmV0dXJuIHMgIT09IHVuZGVmaW5lZDsgfVxyXG52YXIgZW1wdHlOb2RlID0gdm5vZGVfMS5kZWZhdWx0KCcnLCB7fSwgW10sIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcclxuZnVuY3Rpb24gc2FtZVZub2RlKHZub2RlMSwgdm5vZGUyKSB7XHJcbiAgICByZXR1cm4gdm5vZGUxLmtleSA9PT0gdm5vZGUyLmtleSAmJiB2bm9kZTEuc2VsID09PSB2bm9kZTIuc2VsO1xyXG59XHJcbmZ1bmN0aW9uIGlzVm5vZGUodm5vZGUpIHtcclxuICAgIHJldHVybiB2bm9kZS5zZWwgIT09IHVuZGVmaW5lZDtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVLZXlUb09sZElkeChjaGlsZHJlbiwgYmVnaW5JZHgsIGVuZElkeCkge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgdmFyIG1hcCA9IHt9O1xyXG4gICAgZm9yICh2YXIgaSA9IGJlZ2luSWR4OyBpIDw9IGVuZElkeDsgKytpKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IChfYSA9IGNoaWxkcmVuW2ldKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eua2V5O1xyXG4gICAgICAgIGlmIChrZXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBtYXBba2V5XSA9IGk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG1hcDtcclxufVxyXG52YXIgaG9va3MgPSBbJ2NyZWF0ZScsICd1cGRhdGUnLCAncmVtb3ZlJywgJ2Rlc3Ryb3knLCAncHJlJywgJ3Bvc3QnXTtcclxudmFyIGhfMSA9IHJlcXVpcmUoXCIuL2hcIik7XHJcbmV4cG9ydHMuaCA9IGhfMS5oO1xyXG52YXIgdGh1bmtfMSA9IHJlcXVpcmUoXCIuL3RodW5rXCIpO1xyXG5leHBvcnRzLnRodW5rID0gdGh1bmtfMS50aHVuaztcclxuZnVuY3Rpb24gaW5pdChtb2R1bGVzLCBkb21BcGkpIHtcclxuICAgIHZhciBpLCBqLCBjYnMgPSB7fTtcclxuICAgIHZhciBhcGkgPSBkb21BcGkgIT09IHVuZGVmaW5lZCA/IGRvbUFwaSA6IGh0bWxkb21hcGlfMS5kZWZhdWx0O1xyXG4gICAgZm9yIChpID0gMDsgaSA8IGhvb2tzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgY2JzW2hvb2tzW2ldXSA9IFtdO1xyXG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBtb2R1bGVzLmxlbmd0aDsgKytqKSB7XHJcbiAgICAgICAgICAgIHZhciBob29rID0gbW9kdWxlc1tqXVtob29rc1tpXV07XHJcbiAgICAgICAgICAgIGlmIChob29rICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNic1tob29rc1tpXV0ucHVzaChob29rKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGVtcHR5Tm9kZUF0KGVsbSkge1xyXG4gICAgICAgIHZhciBpZCA9IGVsbS5pZCA/ICcjJyArIGVsbS5pZCA6ICcnO1xyXG4gICAgICAgIHZhciBjID0gZWxtLmNsYXNzTmFtZSA/ICcuJyArIGVsbS5jbGFzc05hbWUuc3BsaXQoJyAnKS5qb2luKCcuJykgOiAnJztcclxuICAgICAgICByZXR1cm4gdm5vZGVfMS5kZWZhdWx0KGFwaS50YWdOYW1lKGVsbSkudG9Mb3dlckNhc2UoKSArIGlkICsgYywge30sIFtdLCB1bmRlZmluZWQsIGVsbSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVSbUNiKGNoaWxkRWxtLCBsaXN0ZW5lcnMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gcm1DYigpIHtcclxuICAgICAgICAgICAgaWYgKC0tbGlzdGVuZXJzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzEgPSBhcGkucGFyZW50Tm9kZShjaGlsZEVsbSk7XHJcbiAgICAgICAgICAgICAgICBhcGkucmVtb3ZlQ2hpbGQocGFyZW50XzEsIGNoaWxkRWxtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVFbG0odm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSkge1xyXG4gICAgICAgIHZhciBfYSwgX2IsIF9jO1xyXG4gICAgICAgIHZhciBpLCBkYXRhID0gdm5vZGUuZGF0YTtcclxuICAgICAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHZhciBpbml0XzEgPSAoX2EgPSBkYXRhLmhvb2spID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbml0O1xyXG4gICAgICAgICAgICBpZiAoaXNEZWYoaW5pdF8xKSkge1xyXG4gICAgICAgICAgICAgICAgaW5pdF8xKHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSB2bm9kZS5kYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHZub2RlLmNoaWxkcmVuLCBzZWwgPSB2bm9kZS5zZWw7XHJcbiAgICAgICAgaWYgKHNlbCA9PT0gJyEnKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1VuZGVmKHZub2RlLnRleHQpKSB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS50ZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdm5vZGUuZWxtID0gYXBpLmNyZWF0ZUNvbW1lbnQodm5vZGUudGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHNlbCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIC8vIFBhcnNlIHNlbGVjdG9yXHJcbiAgICAgICAgICAgIHZhciBoYXNoSWR4ID0gc2VsLmluZGV4T2YoJyMnKTtcclxuICAgICAgICAgICAgdmFyIGRvdElkeCA9IHNlbC5pbmRleE9mKCcuJywgaGFzaElkeCk7XHJcbiAgICAgICAgICAgIHZhciBoYXNoID0gaGFzaElkeCA+IDAgPyBoYXNoSWR4IDogc2VsLmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGRvdCA9IGRvdElkeCA+IDAgPyBkb3RJZHggOiBzZWwubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgdGFnID0gaGFzaElkeCAhPT0gLTEgfHwgZG90SWR4ICE9PSAtMSA/IHNlbC5zbGljZSgwLCBNYXRoLm1pbihoYXNoLCBkb3QpKSA6IHNlbDtcclxuICAgICAgICAgICAgdmFyIGVsbSA9IHZub2RlLmVsbSA9IGlzRGVmKGRhdGEpICYmIGlzRGVmKGkgPSBkYXRhLm5zKVxyXG4gICAgICAgICAgICAgICAgPyBhcGkuY3JlYXRlRWxlbWVudE5TKGksIHRhZylcclxuICAgICAgICAgICAgICAgIDogYXBpLmNyZWF0ZUVsZW1lbnQodGFnKTtcclxuICAgICAgICAgICAgaWYgKGhhc2ggPCBkb3QpXHJcbiAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKCdpZCcsIHNlbC5zbGljZShoYXNoICsgMSwgZG90KSk7XHJcbiAgICAgICAgICAgIGlmIChkb3RJZHggPiAwKVxyXG4gICAgICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBzZWwuc2xpY2UoZG90ICsgMSkucmVwbGFjZSgvXFwuL2csICcgJykpO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLmNyZWF0ZS5sZW5ndGg7ICsraSlcclxuICAgICAgICAgICAgICAgIGNicy5jcmVhdGVbaV0oZW1wdHlOb2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgIGlmIChpcy5hcnJheShjaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjaCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5hcHBlbmRDaGlsZChlbG0sIGNyZWF0ZUVsbShjaCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzLnByaW1pdGl2ZSh2bm9kZS50ZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmFwcGVuZENoaWxkKGVsbSwgYXBpLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaG9vayA9IHZub2RlLmRhdGEuaG9vaztcclxuICAgICAgICAgICAgaWYgKGlzRGVmKGhvb2spKSB7XHJcbiAgICAgICAgICAgICAgICAoX2MgPSAoX2IgPSBob29rKS5jcmVhdGUpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jYWxsKF9iLCBlbXB0eU5vZGUsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChob29rLmluc2VydCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc2VydGVkVm5vZGVRdWV1ZS5wdXNoKHZub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdm5vZGUuZWxtID0gYXBpLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdm5vZGUuZWxtO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYWRkVm5vZGVzKHBhcmVudEVsbSwgYmVmb3JlLCB2bm9kZXMsIHN0YXJ0SWR4LCBlbmRJZHgsIGluc2VydGVkVm5vZGVRdWV1ZSkge1xyXG4gICAgICAgIGZvciAoOyBzdGFydElkeCA8PSBlbmRJZHg7ICsrc3RhcnRJZHgpIHtcclxuICAgICAgICAgICAgdmFyIGNoID0gdm5vZGVzW3N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgaWYgKGNoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBjcmVhdGVFbG0oY2gsIGluc2VydGVkVm5vZGVRdWV1ZSksIGJlZm9yZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpbnZva2VEZXN0cm95SG9vayh2bm9kZSkge1xyXG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcclxuICAgICAgICB2YXIgZGF0YSA9IHZub2RlLmRhdGE7XHJcbiAgICAgICAgaWYgKGRhdGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAoX2QgPSAoX2IgPSAoX2EgPSBkYXRhKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaG9vaykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfYyA9IF9iKS5kZXN0cm95KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuY2FsbChfYywgdm5vZGUpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpXzEgPSAwOyBpXzEgPCBjYnMuZGVzdHJveS5sZW5ndGg7ICsraV8xKVxyXG4gICAgICAgICAgICAgICAgY2JzLmRlc3Ryb3lbaV8xXSh2bm9kZSk7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5jaGlsZHJlbiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqXzEgPSAwOyBqXzEgPCB2bm9kZS5jaGlsZHJlbi5sZW5ndGg7ICsral8xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gdm5vZGUuY2hpbGRyZW5bal8xXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQgIT0gbnVsbCAmJiB0eXBlb2YgY2hpbGQgIT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW52b2tlRGVzdHJveUhvb2soY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlbW92ZVZub2RlcyhwYXJlbnRFbG0sIHZub2Rlcywgc3RhcnRJZHgsIGVuZElkeCkge1xyXG4gICAgICAgIHZhciBfYSwgX2IsIF9jO1xyXG4gICAgICAgIGZvciAoOyBzdGFydElkeCA8PSBlbmRJZHg7ICsrc3RhcnRJZHgpIHtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVycyA9IHZvaWQgMCwgcm0gPSB2b2lkIDAsIGNoID0gdm5vZGVzW3N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgaWYgKGNoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc0RlZihjaC5zZWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52b2tlRGVzdHJveUhvb2soY2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycyA9IGNicy5yZW1vdmUubGVuZ3RoICsgMTtcclxuICAgICAgICAgICAgICAgICAgICBybSA9IGNyZWF0ZVJtQ2IoY2guZWxtLCBsaXN0ZW5lcnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGlfMiA9IDA7IGlfMiA8IGNicy5yZW1vdmUubGVuZ3RoOyArK2lfMilcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2JzLnJlbW92ZVtpXzJdKGNoLCBybSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW92ZUhvb2sgPSAoX2MgPSAoX2IgPSAoX2EgPSBjaCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhdGEpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5ob29rKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MucmVtb3ZlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0RlZihyZW1vdmVIb29rKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVIb29rKGNoLCBybSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBybSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBUZXh0IG5vZGVcclxuICAgICAgICAgICAgICAgICAgICBhcGkucmVtb3ZlQ2hpbGQocGFyZW50RWxtLCBjaC5lbG0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlQ2hpbGRyZW4ocGFyZW50RWxtLCBvbGRDaCwgbmV3Q2gsIGluc2VydGVkVm5vZGVRdWV1ZSkge1xyXG4gICAgICAgIHZhciBvbGRTdGFydElkeCA9IDAsIG5ld1N0YXJ0SWR4ID0gMDtcclxuICAgICAgICB2YXIgb2xkRW5kSWR4ID0gb2xkQ2gubGVuZ3RoIC0gMTtcclxuICAgICAgICB2YXIgb2xkU3RhcnRWbm9kZSA9IG9sZENoWzBdO1xyXG4gICAgICAgIHZhciBvbGRFbmRWbm9kZSA9IG9sZENoW29sZEVuZElkeF07XHJcbiAgICAgICAgdmFyIG5ld0VuZElkeCA9IG5ld0NoLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgdmFyIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFswXTtcclxuICAgICAgICB2YXIgbmV3RW5kVm5vZGUgPSBuZXdDaFtuZXdFbmRJZHhdO1xyXG4gICAgICAgIHZhciBvbGRLZXlUb0lkeDtcclxuICAgICAgICB2YXIgaWR4SW5PbGQ7XHJcbiAgICAgICAgdmFyIGVsbVRvTW92ZTtcclxuICAgICAgICB2YXIgYmVmb3JlO1xyXG4gICAgICAgIHdoaWxlIChvbGRTdGFydElkeCA8PSBvbGRFbmRJZHggJiYgbmV3U3RhcnRJZHggPD0gbmV3RW5kSWR4KSB7XHJcbiAgICAgICAgICAgIGlmIChvbGRTdGFydFZub2RlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsgLy8gVm5vZGUgbWlnaHQgaGF2ZSBiZWVuIG1vdmVkIGxlZnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvbGRFbmRWbm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuZXdTdGFydFZub2RlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuZXdFbmRWbm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkRW5kVm5vZGUsIG5ld0VuZFZub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgcGF0Y2hWbm9kZShvbGRFbmRWbm9kZSwgbmV3RW5kVm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdFbmRWbm9kZSkpIHsgLy8gVm5vZGUgbW92ZWQgcmlnaHRcclxuICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3RW5kVm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0QmVmb3JlKHBhcmVudEVsbSwgb2xkU3RhcnRWbm9kZS5lbG0sIGFwaS5uZXh0U2libGluZyhvbGRFbmRWbm9kZS5lbG0pKTtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNhbWVWbm9kZShvbGRFbmRWbm9kZSwgbmV3U3RhcnRWbm9kZSkpIHsgLy8gVm5vZGUgbW92ZWQgbGVmdFxyXG4gICAgICAgICAgICAgICAgcGF0Y2hWbm9kZShvbGRFbmRWbm9kZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBvbGRFbmRWbm9kZS5lbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtKTtcclxuICAgICAgICAgICAgICAgIG9sZEVuZFZub2RlID0gb2xkQ2hbLS1vbGRFbmRJZHhdO1xyXG4gICAgICAgICAgICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9sZEtleVRvSWR4ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBvbGRLZXlUb0lkeCA9IGNyZWF0ZUtleVRvT2xkSWR4KG9sZENoLCBvbGRTdGFydElkeCwgb2xkRW5kSWR4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlkeEluT2xkID0gb2xkS2V5VG9JZHhbbmV3U3RhcnRWbm9kZS5rZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzVW5kZWYoaWR4SW5PbGQpKSB7IC8vIE5ldyBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIGNyZWF0ZUVsbShuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpLCBvbGRTdGFydFZub2RlLmVsbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxtVG9Nb3ZlID0gb2xkQ2hbaWR4SW5PbGRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbG1Ub01vdmUuc2VsICE9PSBuZXdTdGFydFZub2RlLnNlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0QmVmb3JlKHBhcmVudEVsbSwgY3JlYXRlRWxtKG5ld1N0YXJ0Vm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSksIG9sZFN0YXJ0Vm5vZGUuZWxtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUoZWxtVG9Nb3ZlLCBuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRDaFtpZHhJbk9sZF0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBlbG1Ub01vdmUuZWxtLCBvbGRTdGFydFZub2RlLmVsbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2xkU3RhcnRJZHggPD0gb2xkRW5kSWR4IHx8IG5ld1N0YXJ0SWR4IDw9IG5ld0VuZElkeCkge1xyXG4gICAgICAgICAgICBpZiAob2xkU3RhcnRJZHggPiBvbGRFbmRJZHgpIHtcclxuICAgICAgICAgICAgICAgIGJlZm9yZSA9IG5ld0NoW25ld0VuZElkeCArIDFdID09IG51bGwgPyBudWxsIDogbmV3Q2hbbmV3RW5kSWR4ICsgMV0uZWxtO1xyXG4gICAgICAgICAgICAgICAgYWRkVm5vZGVzKHBhcmVudEVsbSwgYmVmb3JlLCBuZXdDaCwgbmV3U3RhcnRJZHgsIG5ld0VuZElkeCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVZub2RlcyhwYXJlbnRFbG0sIG9sZENoLCBvbGRTdGFydElkeCwgb2xkRW5kSWR4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHBhdGNoVm5vZGUob2xkVm5vZGUsIHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpIHtcclxuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oLCBfaiwgX2s7XHJcbiAgICAgICAgdmFyIGhvb2sgPSAoX2EgPSB2bm9kZS5kYXRhKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaG9vaztcclxuICAgICAgICAoX2QgPSAoX2IgPSBob29rKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9jID0gX2IpLnByZXBhdGNoKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuY2FsbChfYywgb2xkVm5vZGUsIHZub2RlKTtcclxuICAgICAgICB2YXIgZWxtID0gdm5vZGUuZWxtID0gb2xkVm5vZGUuZWxtO1xyXG4gICAgICAgIHZhciBvbGRDaCA9IG9sZFZub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIHZhciBjaCA9IHZub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIGlmIChvbGRWbm9kZSA9PT0gdm5vZGUpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBpZiAodm5vZGUuZGF0YSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGlfMyA9IDA7IGlfMyA8IGNicy51cGRhdGUubGVuZ3RoOyArK2lfMylcclxuICAgICAgICAgICAgICAgIGNicy51cGRhdGVbaV8zXShvbGRWbm9kZSwgdm5vZGUpO1xyXG4gICAgICAgICAgICAoX2cgPSAoX2UgPSB2bm9kZS5kYXRhLmhvb2spID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2YgPSBfZSkudXBkYXRlKSA9PT0gbnVsbCB8fCBfZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2cuY2FsbChfZiwgb2xkVm5vZGUsIHZub2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzVW5kZWYodm5vZGUudGV4dCkpIHtcclxuICAgICAgICAgICAgaWYgKGlzRGVmKG9sZENoKSAmJiBpc0RlZihjaCkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvbGRDaCAhPT0gY2gpXHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2hpbGRyZW4oZWxtLCBvbGRDaCwgY2gsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYoY2gpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpXHJcbiAgICAgICAgICAgICAgICAgICAgYXBpLnNldFRleHRDb250ZW50KGVsbSwgJycpO1xyXG4gICAgICAgICAgICAgICAgYWRkVm5vZGVzKGVsbSwgbnVsbCwgY2gsIDAsIGNoLmxlbmd0aCAtIDEsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYob2xkQ2gpKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMoZWxtLCBvbGRDaCwgMCwgb2xkQ2gubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpIHtcclxuICAgICAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sICcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvbGRWbm9kZS50ZXh0ICE9PSB2bm9kZS50ZXh0KSB7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZihvbGRDaCkpIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVZub2RlcyhlbG0sIG9sZENoLCAwLCBvbGRDaC5sZW5ndGggLSAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhcGkuc2V0VGV4dENvbnRlbnQoZWxtLCB2bm9kZS50ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgKF9rID0gKF9oID0gaG9vaykgPT09IG51bGwgfHwgX2ggPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfaiA9IF9oKS5wb3N0cGF0Y2gpID09PSBudWxsIHx8IF9rID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfay5jYWxsKF9qLCBvbGRWbm9kZSwgdm5vZGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIHBhdGNoKG9sZFZub2RlLCB2bm9kZSkge1xyXG4gICAgICAgIHZhciBpLCBlbG0sIHBhcmVudDtcclxuICAgICAgICB2YXIgaW5zZXJ0ZWRWbm9kZVF1ZXVlID0gW107XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNicy5wcmUubGVuZ3RoOyArK2kpXHJcbiAgICAgICAgICAgIGNicy5wcmVbaV0oKTtcclxuICAgICAgICBpZiAoIWlzVm5vZGUob2xkVm5vZGUpKSB7XHJcbiAgICAgICAgICAgIG9sZFZub2RlID0gZW1wdHlOb2RlQXQob2xkVm5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2FtZVZub2RlKG9sZFZub2RlLCB2bm9kZSkpIHtcclxuICAgICAgICAgICAgcGF0Y2hWbm9kZShvbGRWbm9kZSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlbG0gPSBvbGRWbm9kZS5lbG07XHJcbiAgICAgICAgICAgIHBhcmVudCA9IGFwaS5wYXJlbnROb2RlKGVsbSk7XHJcbiAgICAgICAgICAgIGNyZWF0ZUVsbSh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgaWYgKHBhcmVudCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnQsIHZub2RlLmVsbSwgYXBpLm5leHRTaWJsaW5nKGVsbSkpO1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlVm5vZGVzKHBhcmVudCwgW29sZFZub2RlXSwgMCwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGluc2VydGVkVm5vZGVRdWV1ZS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBpbnNlcnRlZFZub2RlUXVldWVbaV0uZGF0YS5ob29rLmluc2VydChpbnNlcnRlZFZub2RlUXVldWVbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLnBvc3QubGVuZ3RoOyArK2kpXHJcbiAgICAgICAgICAgIGNicy5wb3N0W2ldKCk7XHJcbiAgICAgICAgcmV0dXJuIHZub2RlO1xyXG4gICAgfTtcclxufVxyXG5leHBvcnRzLmluaXQgPSBpbml0O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbmFiYmRvbS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG52YXIgaF8xID0gcmVxdWlyZShcIi4vaFwiKTtcclxuZnVuY3Rpb24gY29weVRvVGh1bmsodm5vZGUsIHRodW5rKSB7XHJcbiAgICB0aHVuay5lbG0gPSB2bm9kZS5lbG07XHJcbiAgICB2bm9kZS5kYXRhLmZuID0gdGh1bmsuZGF0YS5mbjtcclxuICAgIHZub2RlLmRhdGEuYXJncyA9IHRodW5rLmRhdGEuYXJncztcclxuICAgIHRodW5rLmRhdGEgPSB2bm9kZS5kYXRhO1xyXG4gICAgdGh1bmsuY2hpbGRyZW4gPSB2bm9kZS5jaGlsZHJlbjtcclxuICAgIHRodW5rLnRleHQgPSB2bm9kZS50ZXh0O1xyXG4gICAgdGh1bmsuZWxtID0gdm5vZGUuZWxtO1xyXG59XHJcbmZ1bmN0aW9uIGluaXQodGh1bmspIHtcclxuICAgIHZhciBjdXIgPSB0aHVuay5kYXRhO1xyXG4gICAgdmFyIHZub2RlID0gY3VyLmZuLmFwcGx5KHVuZGVmaW5lZCwgY3VyLmFyZ3MpO1xyXG4gICAgY29weVRvVGh1bmsodm5vZGUsIHRodW5rKTtcclxufVxyXG5mdW5jdGlvbiBwcmVwYXRjaChvbGRWbm9kZSwgdGh1bmspIHtcclxuICAgIHZhciBpLCBvbGQgPSBvbGRWbm9kZS5kYXRhLCBjdXIgPSB0aHVuay5kYXRhO1xyXG4gICAgdmFyIG9sZEFyZ3MgPSBvbGQuYXJncywgYXJncyA9IGN1ci5hcmdzO1xyXG4gICAgaWYgKG9sZC5mbiAhPT0gY3VyLmZuIHx8IG9sZEFyZ3MubGVuZ3RoICE9PSBhcmdzLmxlbmd0aCkge1xyXG4gICAgICAgIGNvcHlUb1RodW5rKGN1ci5mbi5hcHBseSh1bmRlZmluZWQsIGFyZ3MpLCB0aHVuayk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgZm9yIChpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICBpZiAob2xkQXJnc1tpXSAhPT0gYXJnc1tpXSkge1xyXG4gICAgICAgICAgICBjb3B5VG9UaHVuayhjdXIuZm4uYXBwbHkodW5kZWZpbmVkLCBhcmdzKSwgdGh1bmspO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29weVRvVGh1bmsob2xkVm5vZGUsIHRodW5rKTtcclxufVxyXG5leHBvcnRzLnRodW5rID0gZnVuY3Rpb24gdGh1bmsoc2VsLCBrZXksIGZuLCBhcmdzKSB7XHJcbiAgICBpZiAoYXJncyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgYXJncyA9IGZuO1xyXG4gICAgICAgIGZuID0ga2V5O1xyXG4gICAgICAgIGtleSA9IHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIHJldHVybiBoXzEuaChzZWwsIHtcclxuICAgICAgICBrZXk6IGtleSxcclxuICAgICAgICBob29rOiB7IGluaXQ6IGluaXQsIHByZXBhdGNoOiBwcmVwYXRjaCB9LFxyXG4gICAgICAgIGZuOiBmbixcclxuICAgICAgICBhcmdzOiBhcmdzXHJcbiAgICB9KTtcclxufTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gZXhwb3J0cy50aHVuaztcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGh1bmsuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZnVuY3Rpb24gdm5vZGUoc2VsLCBkYXRhLCBjaGlsZHJlbiwgdGV4dCwgZWxtKSB7XHJcbiAgICB2YXIga2V5ID0gZGF0YSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogZGF0YS5rZXk7XHJcbiAgICByZXR1cm4geyBzZWw6IHNlbCwgZGF0YTogZGF0YSwgY2hpbGRyZW46IGNoaWxkcmVuLCB0ZXh0OiB0ZXh0LCBlbG06IGVsbSwga2V5OiBrZXkgfTtcclxufVxyXG5leHBvcnRzLnZub2RlID0gdm5vZGU7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHZub2RlO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD12bm9kZS5qcy5tYXAiXX0=\n"]}